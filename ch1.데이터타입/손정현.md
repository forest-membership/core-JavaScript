# 변수 선언과 데이터 할당

## 변수란?

`변수` 는 `변경 가능한 데이터가 담길 수 있는 공간` 입니다.

다음과 같은 변수 선언문을 보겠습니다.

```jsx
const a = "abc";
```

자바스크립트 엔진은 위 선언문을 어떤 방식으로 처리할까요?

이는 다음과 같습니다.

```
-------------------------------------------------------
|      |      |  1002  |     1003   |  1004  |  ...   |
|      |      |        |  이름: a    |        |  ...   |  -> 변수 영역
|      |      |        |  값: @5004  |        |  ...   |
-------------------------------------------------------
|      |      |  5002  |    5003    |   5004   |
|      |      |        |            |   'abc'  |   -> 데이터 영역
|      |      |        |            |          |
-------------------------------------------------
```

왜 굳이 변수 영역에 값을 바로 대입하지 않고 번거롭게 한 단계를 더 거치는 것일까요?

이는 데이터 변환을 자유롭게함과 동시에 메모리를 더욱 효율적으로 관리하기 위함입니다.

예를 들어 문자열의 경우 영어는 1바이트, 한글은 2바이트입니다.

따라서 각각 필요한 메모리 용량이 가변적이기 때문에 메모리 공간을 지정해놓기 어렵습니다.

왜나하면 이미 확보된 공간을 늘리기 위해서는 해당 공간보다 뒤에 있는 공간을 다 뒤로 옮기는 작업이 필요합니다.

또한 변수 영역과 데이터 영역을 분리하면 중복된 데이터에 대한 처리 효율도 높아집니다.

컴퓨터는 데이터 영역에 존재하는 중복된 값을 재활용하기 때문입니다.

# 불변값과 가변값

## 변수 영역과 데이터 영역

변수와 상수를 구분 짓는 변경 가능성의 대상은 `변수 영역` 메모리입니다.

반면에 불변성 여부를 구분할 때의 변경 가능성은 `데이터 영역` 을 대상으로 합니다.

## 불변값 예제

기본형 데이터인 `Number, String, Boolean, Symbol, undefined, null` 은 모두 불변값입니다.

```jsx
let a = "abc";
a = a + "def";
```

위 예제에서 변수 `a` 에 `abc` 를 할당했다가 이후 `def` 를 추가하면

기존의 데이터 영역에 존재하는 `abc` 가 변경되는 것이 아니라

`abcdef` 라는 새로운 데이터가 생성된 뒤 할당됩니다.

이를 통해 한번 만들어진 값은 `GC` 대상이 되지 않는 한 영원히 변하지 않습니다.

## 가변값 예제

참조형 데이터는 모두 가변값입니다.

기본형 데이터와의 차이점은 `객체의 변수(프로퍼티) 영역이 별도로 존재한다` 라는 것입니다.

데이터 영역에 저장된 값은 모두 불변값입니다.

그러나 변수 영역에는 다른 값을 얼마든지 대입할 수 있기 때문에 참조형 데이터는 가변값이라고 하는 것입니다.

```jsx
const obj = {
  a: 1,
  b: "bbb",
};
obj.a = 2;
```

# 기본형 데이터와 참조형 데이터의 복사 방식

⚠️ 기본형 데이터와 참조형 데이터의 복사 동작 과정은 책을 참고합니다.

내부적으로 메모리는 `변수 영역` 과 `데이터 영역` 으로 구분됩니다.

기본형 데이터라도 변수 영역에 값을 바로 대입하는 것이 아니라

데이터 영역의 주소값을 대입하는 방법으로 동작합니다.

대부분의 자바스크립트 책에서 기본형은 값을 복사하고 참조형은 주소값을 복사한다고 하지만

따지고 보면 모든 타입이 주소값을 복사해야합니다.

다만 참조형은 `객체의 프로퍼티 영역` 을 한 단계 더 거치는 차이점이 존재하는 것입니다.

또한 참조형 데이터가 `가변값` 이라고 설명할 때의 `가변` 은 참조형 데이터 자체를 변경하는 경우가 아니라

그 내부의 프로퍼티를 변경할 때 성립합니다. (객체의 변수(프로퍼티) 영역)

`**기본형도 결국 주소값을 참조한다` 는 사실을 소개하지 않는 이유는\*\*

**이해하기에 다소 어려움이 있기 때문이 아닐까하고 저자는 말하고 있습니다.**

# (참고) typeof null 이 object 인 이유?

[The history of "typeof null"](https://2ality.com/2013/10/typeof-null.html)

[Why is typeof null "object"?](https://stackoverflow.com/questions/18808226/why-is-typeof-null-object)

# 참고자료

[자바스크립트의 메모리 모델](https://junwoo45.github.io/2019-11-04-memory_model/)
